<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NovaVault - Home</title>
  <style>
    :root{ --bg:#0f1222; --card:#161a2f; --accent:#7c5cff; --accent-2:#4ad4ff; --text:#e8eaed; --muted:#a8b0c2; }
    body{ margin:0; font-family: sans-serif; color:var(--text); background: var(--bg); min-height: 100vh; display: flex; flex-direction: column; }
    .container{ max-width:1100px; margin:0 auto; padding:32px 20px; flex: 1; }
    header{ display:flex; align-items:center; justify-content:space-between; }
    .btn{ cursor:pointer; font-weight:600; border-radius:12px; padding:10px 16px; border:none; color:var(--text); background:#232845; }
    .btn-primary{ background:linear-gradient(135deg, var(--accent), var(--accent-2)); color:#0b0f1a; }
    .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,0.8); backdrop-filter:blur(4px); display:none; align-items:center; justify-content:center; z-index:999; }
    .modal{ width:90%; max-width:400px; background:#121631; border-radius:18px; padding:24px; border:1px solid #2a3154; }
    .form{ display:grid; gap:15px; }
    .form input{ padding:12px; border-radius:10px; border:1px solid #2a3154; background:#0f1328; color:white; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>NovaVault</h1>
      <nav>
        <button class="btn" id="open-auth">Login / Register</button> 
        <a href="Constraints.html"><button class="btn btn-primary">Password Generator</button></a>
      </nav>
    </header>
    <main style="text-align: center; margin-top: 100px;">
      <h2>Secure Cloud Vault</h2>
    </main>
  </div>

  <div class="modal-backdrop" id="auth-modal">
    <div class="modal">
      <h3 id="modal-title">Register Account</h3>
      <form class="form" id="register-form">
        <input type="email" id="reg-email" placeholder="Email Address" required>
        <input type="password" id="reg-pass" placeholder="Password" required>
        <button type="submit" class="btn btn-primary">Create Account</button>
      </form>
      <p style="text-align:center">Already have an account? <a href="PG-2.html" style="color:var(--accent-2)">Login here</a></p>
      <button class="btn" style="width:100%" id="close-modal">Cancel</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC4tcA_TjLw6tsxjUyuhlIQkj2Yg4EZ530",
      authDomain: "novavault-e5e9f.firebaseapp.com",
      projectId: "novavault-e5e9f",
      databaseURL: "https://novavault-e5e9f-default-rtdb.firebaseio.com/",
      appId: "1:24832406592:web:1b1b185bfc0310e9e55ba5"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    // --- DOM ELEMENTS ---
    const modal = document.getElementById('auth-modal');
    const openBtn = document.getElementById('open-auth');
    const closeBtn = document.getElementById('close-modal');
    const regForm = document.getElementById('register-form');

    // --- BUTTON EVENT LISTENERS ---
    openBtn.onclick = () => { 
        console.log("Opening Modal...");
        modal.style.display = 'flex'; 
    };
    
    closeBtn.onclick = () => { modal.style.display = 'none'; };

    // --- REGISTRATION LOGIC ---
    regForm.onsubmit = async (e) => {
      e.preventDefault();
      const email = document.getElementById('reg-email').value;
      const pass = document.getElementById('reg-pass').value;

      const masterKey = prompt("Set your Master Key (Important!):");
      if(!masterKey) return;

      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
        await set(ref(db, 'users/' + userCredential.user.uid), { email, masterKey });
        alert("Success!");
        window.location.href = "PG-2.html";
      } catch (error) { alert(error.message); }
    };
  </script>
</body>
</html>
